# Руководство пользователя VolleyScore Master

## Содержание

1. [Начало работы](#начало-работы)
2. [Создание и открытие матчей](#создание-и-открытие-матчей)
3. [Управление матчем](#управление-матчем)
4. [Настройка матча](#настройка-матча)
5. [Управление составами команд](#управление-составами-команд)
6. [Настройка интеграции с vMix](#настройка-интеграции-с-vmix)
7. [Мобильный доступ](#мобильный-доступ)
8. [Сохранение и загрузка матчей](#сохранение-и-загрузка-матчей)
9. [Горячие клавиши](#горячие-клавиши)
10. [Часто задаваемые вопросы](#часто-задаваемые-вопросы)

---

## Начало работы

### Первый запуск

1. Запустите приложение **VolleyScore Master**
2. Откроется главная страница "Добро пожаловать"
3. На главной странице отображается:
   - Статус подключения к vMix (по сохранённым настройкам: «Подключено» или «Не подключено»)
   - Кнопка "Создать новый матч"
   - Кнопка "Открыть существующий матч"

### Интерфейс приложения

Приложение состоит из следующих страниц:

- **Главная** — создание и открытие матчей
- **Управление матчем** — основная рабочая страница для ведения счета
- **Настройки матча** — настройка параметров текущего матча
- **Управление составами** — управление составами команд
- **Настройки vMix** — конфигурация подключения к vMix
- **Мобильный доступ** — настройка удаленного доступа
- **О программе** — информация о приложении

Навигация между страницами осуществляется через меню в верхней части окна. Рекомендуемая минимальная ширина окна — 1280 px.

---

## Создание и открытие матчей

### Создание нового матча

**Способ 1: Через главную страницу**
1. На главной странице нажмите кнопку **"Создать новый матч"**
2. Откроется страница "Управление матчем" с пустым матчем

**Способ 2: Через меню**
1. В меню выберите **"Файл" → "Создать новый матч"**
2. Или используйте горячую клавишу `Ctrl+N`

**Что происходит при создании:**
- Создается новый пустой матч с настройками по умолчанию
- Команды называются "Команда А" и "Команда Б"
- Счет сбрасывается на 0:0
- Текущая партия — первая
- Логотипы команд очищаются (если были)

### Открытие существующего матча

**Способ 1: Через главную страницу**
1. На главной странице нажмите кнопку **"Открыть существующий матч"**
2. В открывшемся диалоге выберите файл матча (формат `.json`)
3. Нажмите "Открыть"

**Способ 2: Через меню**
1. В меню выберите **"Файл" → "Открыть матч..."**
2. Или используйте горячую клавишу `Ctrl+O`
3. Выберите файл матча и нажмите "Открыть"

**Формат файлов:**
- Матчи сохраняются в формате JSON
- Имя файла обычно: `match_[ID].json`
- Файлы находятся в папке `matches/` (создается автоматически)

**Важно:**
- При открытии матча все несохраненные изменения текущего матча будут потеряны
- Приложение предупредит вас, если есть несохраненные изменения

---

## Управление матчем

Страница "Управление матчем" — это основная рабочая страница для ведения счета.

### Отображение информации о матче

В верхней части страницы отображается:
- Название турнира
- Место проведения
- Дата и время матча
- Названия команд и их цвета

### Счет по партиям

Отображается результат каждой завершенной партии:
- Партия 1: [25] - [20]
- Партия 2: [23] - [25]
- Партия 3: [  ] - [  ] (еще не завершена)
- И т.д.

### Текущая партия

**Отображение счета:**
- Текущий счет команды А и команды Б
- Индикатор подачи (какая команда подает)

**Управление счетом:**
- Кнопки **"+1"** и **"-1"** для каждой команды
- При нажатии "+1" счет увеличивается на 1 очко
- При нажатии "-1" счет уменьшается на 1 очко (отмена последнего очка)
- При начислении очка подача автоматически переходит к другой команде

**Управление подачей:**
- Кнопки **"◄"** и **"►"** для ручной коррекции подачи
- Используйте, если нужно исправить, какая команда подает

**Индикаторы:**
- **Сетбол** — отображается, когда одна из команд близка к победе в партии (24 очка)
- **Матчбол** — отображается, когда одна из команд может выиграть матч

### Завершение партии

1. Нажмите кнопку **"Завершить партию"**
2. Партия завершится, и результат сохранится
3. Автоматически начнется следующая партия (если матч не завершен)

**Условия завершения партии:**
- Одна из команд набрала 25 очков с преимуществом минимум в 2 очка
- Или достигнут счет 24:24 и далее до преимущества в 2 очка

### Отмена последнего действия

- Нажмите кнопку **"Отменить последнее действие"**
- Отменится последнее изменение счета
- Можно отменить несколько действий подряд

### Расширенная статистика

**Включение статистики:**
1. На странице "Управление матчем" найдите раздел "Расширенная статистика"
2. Установите галочку "Расширенная статистика"

**Ведение статистики:**
Для каждой команды доступны категории:
- **Атака** — количество успешных атак
- **Блок** — количество блоков
- **Подачи** — количество успешных подач
- **Ошибки соперника** — очки, заработанные из-за ошибок соперника

**Управление:**
- Кнопки **"+1"** и **"-1"** для увеличения/уменьшения значения
- Значения статистики можно сопоставить с полями инпутов vMix в настройках (раздел «Расширенная статистика» в списке «Данные приложения»)

### Управление плашками vMix

На странице "Управление матчем" в блоке «Управление плашками vMix» отображаются кнопки для показа/скрытия плашек в vMix. Список кнопок формируется из настроенных на странице «Настройки vMix» инпутов (каждый инпут с отображаемым именем даёт одну кнопку).

**Использование:**
- Нажмите кнопку, чтобы показать или скрыть плашку в соответствующем оверлее vMix
- Активная плашка отмечена галочкой (✓)
- При отключённом vMix кнопки недоступны (состояние подключения видно по кнопкам)
- Состояние кнопок синхронизируется с реальным состоянием оверлеев в vMix при установленном подключении

**Важно:** Для работы управления плашками необходимо подключиться к vMix и настроить инпуты (см. раздел "Настройка интеграции с vMix").

---

## Настройка матча

Страница "Настройки матча" позволяет настроить все параметры текущего матча.

### Информация о турнире

- **Заголовок турнира** — название турнира (например, "Чемпионат России")
- **Подзаголовок турнира** — дополнительная информация (например, "Премьер-лига")
- **Город, страна** — место проведения (например, "Москва, Россия")
- **Место проведения** — название арены или зала (например, "ДС "Лужники"")
- **Дата проведения** — дата матча
- **Время начала** — время начала матча

### Команды

**Для каждой команды (А и Б) можно указать:**

- **Название команды** — полное название команды
- **Цвет формы** — цвет формы игроков (HEX формат, например, #3498db)
  - Используется для отображения в интерфейсе и передачи в vMix
- **Цвет формы либеро** — цвет формы либеро (опционально)
- **Логотип команды** — загрузка логотипа команды
  - Поддерживаются форматы: PNG, JPG, JPEG
  - Логотип автоматически сохраняется и используется в vMix
- **Тренер команды** — имя тренера

**Загрузка логотипа:**
1. Нажмите кнопку "Загрузить логотип" или "Выбрать файл"
2. Выберите файл изображения (PNG, JPG, JPEG)
3. Логотип отобразится в превью
4. Логотип автоматически сохранится при сохранении матча

**Смена команд местами:**
1. В разделе "Команды" нажмите кнопку **"⇄ Поменять команды местами"**
2. Подтвердите действие
3. Команды А и Б поменяются местами со всеми данными:
   - Названия команд
   - Цвета и логотипы
   - Составы
   - Счет и статистика

### Судейская коллегия

Укажите информацию о судьях:
- **Главный судья** (1-й судья)
- **Второй судья** (2-й судья)
- **Судья на линии 1**
- **Судья на линии 2**
- **Секретарь**

### Сохранение изменений

После внесения изменений:
1. Нажмите кнопку **"Сохранить изменения"**
2. Изменения сохранятся в текущий матч
3. Если включено автосохранение, изменения автоматически сохранятся в файл

---

## Управление составами команд

Страница "Управление составами" позволяет управлять составами команд.

### Выбор команды

В верхней части страницы выберите команду:
- **Команда А** или **Команда Б**

### Редактирование состава

**Добавление игрока:**
1. Нажмите кнопку **"Добавить игрока"**
2. Заполните информацию:
   - **Номер игрока** — номер на форме
   - **Имя игрока** — полное имя
   - **Позиция** — выберите из списка (Нападающий, Связующий, Центральный блокирующий, Диагональный, Либеро)
3. Нажмите "Сохранить" или "Добавить"

**Редактирование игрока:**
1. Найдите игрока в списке
2. Измените нужные поля
3. Изменения сохранятся автоматически

**Удаление игрока:**
1. Найдите игрока в списке
2. Нажмите кнопку "Удалить" рядом с игроком
3. Подтвердите удаление

### Стартовый состав

Для выбора стартового состава:
1. Найдите раздел "Стартовый состав"
2. Отметьте чекбоксы рядом с номерами игроков, которые выходят в стартовом составе
3. Обычно в стартовом составе 6 игроков
4. Стартовый состав используется для отображения на плашке "Стартовый состав" в vMix

### Импорт и экспорт составов

**Экспорт состава:**
1. Нажмите кнопку **"Экспорт в файл"**
2. Выберите место для сохранения
3. Состав сохранится в JSON файл

**Импорт состава:**
1. Нажмите кнопку **"Загрузить из файла"**
2. Выберите файл состава (JSON формат)
3. Состав загрузится и заменит текущий

---

## Настройка интеграции с vMix

Страница «Настройки подключения к vMix» (меню «Вид» → «Настройки vMix») позволяет настроить подключение к vMix и конфигурацию инпутов.

### Подключение к vMix

**Блок «Подключение»:**
- **IP адрес vMix** — адрес компьютера с vMix (например, `192.168.1.100` или `localhost`)
- **Порт** — порт HTTP API vMix (по умолчанию `8088`)

**Кнопки:**
- **«Подключить»** / **«Отключить»** — устанавливает или снимает постоянное подключение. Состояние сохраняется в настройках и восстанавливается при следующем запуске приложения. При «Подключить» выполняется проверка доступности vMix; при успехе состояние сохраняется как «подключено».
- **«Тест подключения»** — только проверяет доступность vMix по сети и показывает результат; постоянное состояние подключения не меняет.

**Поведение при запуске приложения:**
- Если в настройках сохранено «Отключено» — приложение работает без подключения к vMix.
- Если сохранено «Подключено» — при запуске выполняется проверка доступности vMix; при недоступности состояние автоматически переключается на «Отключено».

**Как узнать IP адрес компьютера с vMix:**  
На компьютере с vMix откройте командную строку, введите `ipconfig` (Windows) или `ifconfig` (Linux/Mac) и найдите IPv4-адрес (обычно 192.168.x.x или 10.x.x.x).

### Настройка инпутов

Инпуты настраиваются **динамически**: вы добавляете инпуты типа GT из списка, который приложение получает из vMix, задаёте отображаемое имя и сопоставляете поля GT с данными матча.

**Блок «Настройка инпутов»:**
- **Слева** — список добавленных инпутов (перетаскивание меняет порядок). Кнопка «Добавить инпут» открывает окно выбора GT-инпута из vMix и ввода отображаемого имени.
- **Справа** (при выборе инпута):
  - Заголовок «Настройки инпута» и справа от него галочка **«Включить инпут»**
  - Строка: **Отображаемое имя** | **Оверлей** (1–8)
  - Строка: **Инпут vMix:** &lt;название&gt; | кнопка **«Повторно сопоставить»** | кнопка **«Удалить инпут»**
  - Панель полей инпута — для каждого поля GT можно выбрать источник данных: пункт из справочника «Данные приложения» (турнир, команды, счёт, составы, расширенная статистика и т.д.) или произвольный текст.

При **отключённом** vMix блок «Настройка инпутов» переходит в режим только для чтения (поля и кнопки недоступны, список не перетаскивается).

**«Повторно сопоставить»** — если инпут был переименован в vMix, открывается окно выбора актуального GT-инпута; после выбора и «Применить» обновляются привязка к vMix, кэш полей сбрасывается.

**Сохранение:**
- Нажмите **«Сохранить»** в шапке страницы (или **«Сохранить настройки»** внизу), чтобы записать настройки в файл настроек. Они подхватываются при следующем запуске и при переходе на страницу матча (с принудительным обновлением данных в vMix).

---

## Мобильный доступ

Страница "Мобильный доступ" позволяет настроить удаленный доступ к приложению с мобильных устройств.

### Запуск мобильного сервера

1. Перейдите на страницу "Мобильный доступ"
2. **Выберите сетевой интерфейс** (если доступно несколько):
   - Выберите интерфейс из выпадающего списка
   - Отображается имя интерфейса, IP адрес и тип (VPN/публичный/частный)
   - Выбор доступен только при остановленном сервере
3. Нажмите кнопку **"Запустить сервер"**
4. Сервер запустится и отобразится:
   - Статус сервера: "Запущен ✓"
   - IP адрес и порт сервера
   - Уникальная ссылка для доступа

### Уникальная ссылка

При первом запуске сервера генерируется уникальная ссылка для доступа:
- Формат: `http://[IP]:[Порт]/panel/[УникальныйID]`
- Пример: `http://192.168.1.50:3000/panel/abc123def456`

**Использование ссылки:**
1. Скопируйте ссылку (кнопка "Копировать ссылку")
2. Отправьте ссылку статисту с мобильным устройством
3. Статист откроет ссылку в браузере на мобильном устройстве
4. Откроется упрощенный интерфейс для управления счетом

**Генерация новой ссылки:**
- Нажмите кнопку **"Сгенерировать новую"**
- Старая ссылка станет недействительной
- Новая ссылка будет отображена

### QR-код

Для быстрого подключения:
1. На странице "Мобильный доступ" отображается QR-код
2. Отсканируйте QR-код камерой мобильного устройства
3. Откроется ссылка для доступа в браузере

### Остановка сервера

1. Нажмите кнопку **"Остановить сервер"**
2. Сервер остановится, и доступ с мобильных устройств прекратится

### Автоматическое восстановление

- При перезапуске приложения сервер автоматически запустится, если он был включен
- Сохраненная ссылка автоматически восстановится
- Выбранный сетевой интерфейс сохраняется в настройках

### Мобильный интерфейс

На мобильном устройстве отображается упрощенный интерфейс:
- Текущий счет
- Кнопки управления счетом (+1, -1)
- Счет по партиям
- Управление подачей
- Завершение партии
- Отмена последнего действия

**Особенности:**
- Управление плашками vMix недоступно в мобильной версии
- Расширенная статистика недоступна в мобильной версии
- Все изменения синхронизируются с основным приложением в реальном времени

---

## Сохранение и загрузка матчей

### Автосохранение

**Включено по умолчанию:**
- Автосохранение автоматически сохраняет матч при изменениях
- Задержка перед сохранением: 2 секунды (debounce)
- При первом сохранении откроется диалог выбора файла
- При последующих сохранениях файл сохраняется автоматически

**Управление автосохранением:**
1. В меню выберите **"Файл" → "Автосохранение"**
2. Снимите/установите галочку для выключения/включения
3. Состояние автосохранения сохраняется в настройках

### Ручное сохранение

**Сохранение матча:**
1. В меню выберите **"Файл" → "Сохранить матч"**
2. Или используйте горячую клавишу `Ctrl+S`
3. Если файл еще не был сохранен, откроется диалог выбора файла
4. Если файл уже был сохранен, матч сохранится в тот же файл

**Сохранение матча как:**
1. В меню выберите **"Файл" → "Сохранить матч как..."**
2. Выберите место для сохранения и имя файла
3. Матч сохранится в новый файл

### Формат файлов

- **Формат:** JSON
- **Расширение:** `.json`
- **Имя файла:** обычно `match_[ID].json`
- **Расположение:** папка `matches/` (создается автоматически)

### Предупреждение о несохраненных изменениях

При закрытии приложения или открытии нового матча:
- Если есть несохраненные изменения, появится предупреждение
- Выберите действие:
  - **Сохранить** — сохранить изменения перед закрытием
  - **Не сохранять** — закрыть без сохранения
  - **Отмена** — вернуться к работе

---

## Горячие клавиши

| Клавиша | Действие |
|---------|----------|
| `Ctrl+N` | Создать новый матч |
| `Ctrl+O` | Открыть матч |
| `Ctrl+S` | Сохранить матч |
| `F5` | Обновить данные в vMix (ручное обновление) |
| `F12` | Открыть/закрыть инструменты разработчика (только для разработчиков) |

---

## Часто задаваемые вопросы

### Общие вопросы

**Q: Как начать работу с приложением?**  
A: Создайте новый матч, настройте параметры матча (команды, турнир), и начните ведение счета.

**Q: Где сохраняются матчи?**  
A: Матчи сохраняются в папке `matches/` в формате JSON. Папка создается автоматически.

**Q: Можно ли использовать приложение без vMix?**  
A: Да, приложение можно использовать для ведения счета без интеграции с vMix. Просто не настраивайте подключение к vMix.

### Вопросы о vMix

**Q: Как узнать IP адрес компьютера с vMix?**  
A: На компьютере с vMix откройте командную строку и введите `ipconfig` (Windows). Найдите IP адрес в разделе "IPv4 Address".

**Q: Какой порт использовать для vMix?**  
A: По умолчанию используется порт `8088`. Если вы изменили порт в настройках vMix, укажите его в настройках приложения.

**Q: Данные не обновляются в vMix. Что делать?**  
A: 
1. Проверьте подключение к vMix (кнопка "Тест подключения")
2. Убедитесь, что имена инпутов и `fieldIdentifier` правильные
3. Попробуйте обновить данные вручную (F5)
4. Проверьте, что HTTP API включен в vMix

**Q: Как настроить инпуты в vMix?**  
A: См. раздел "Настройка интеграции с vMix" в этом руководстве. Убедитесь, что имена инпутов и `fieldIdentifier` соответствуют настройкам в vMix.

### Вопросы о мобильном доступе

**Q: Как подключиться с мобильного устройства?**  
A: Запустите мобильный сервер в приложении, скопируйте уникальную ссылку или отсканируйте QR-код, откройте ссылку в браузере на мобильном устройстве.

**Q: Мобильное устройство не подключается. Что делать?**  
A: 
1. Убедитесь, что мобильное устройство и компьютер в одной сети Wi-Fi
2. Проверьте, что сервер запущен
3. Проверьте правильность ссылки
4. Убедитесь, что брандмауэр не блокирует подключение

**Q: Можно ли использовать мобильный доступ из другой сети?**  
A: Нет, мобильный доступ работает только в локальной сети (Wi-Fi). Для доступа из интернета потребуется настройка VPN или проброс портов.

### Вопросы о сохранении

**Q: Как отключить автосохранение?**  
A: В меню выберите "Файл" → "Автосохранение" и снимите галочку.

**Q: Где найти сохраненные матчи?**  
A: Матчи сохраняются в папке `matches/` в формате JSON. Обычно папка находится в папке пользователя или в папке установки приложения.

**Q: Можно ли экспортировать матч в другой формат?**  
A: В текущей версии матчи сохраняются только в JSON формате. Вы можете открыть JSON файл в текстовом редакторе для просмотра или редактирования.

### Вопросы о работе со счетом

**Q: Как отменить неправильно начисленное очко?**  
A: Используйте кнопку "-1" для команды, которой было неправильно начислено очко, или кнопку "Отменить последнее действие".

**Q: Как исправить подачу?**  
A: Используйте кнопки "◄" и "►" для ручной коррекции подачи.

**Q: Что такое сетбол и матчбол?**  
A: 
- **Сетбол** — ситуация, когда одна из команд близка к победе в партии (24 очка)
- **Матчбол** — ситуация, когда одна из команд может выиграть матч

**Q: Как завершить партию?**  
A: Нажмите кнопку "Завершить партию". Партия завершится автоматически, когда одна из команд наберет 25 очков с преимуществом минимум в 2 очка.

---

## Поддержка

Если у вас возникли вопросы или проблемы:

1. Проверьте этот раздел "Часто задаваемые вопросы"
2. Прочитайте соответствующий раздел руководства
3. Создайте [Issue](https://github.com/ivmoiseev/vmix-volley-scoreboard/issues) на GitHub с описанием проблемы

---

**Версия руководства:** 2.0.0  
**Последнее обновление:** 2026-02-06
