# Changelog

Все значимые изменения в проекте документируются в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

## [Unreleased]

### Добавлено
- **Система глобальных настроек приложения**
  - Создан модуль `settingsManager.js` для управления глобальными настройками
  - Настройки сохраняются в файл `settings.json` в корне проекта
  - Автоматическое создание файла настроек с дефолтными значениями при первом запуске
  - Поддержка миграции настроек при обновлении структуры данных

- **Улучшенная система настроек vMix**
  - Каждый инпут теперь имеет свой собственный оверлей (1-8)
  - Удален общий блок "Выбор оверлея"
  - Добавлены выпадающие списки для выбора оверлея для каждого инпута
  - Настройки vMix сохраняются в глобальный файл настроек

- **Автоматическое восстановление мобильного сервера**
  - Состояние мобильного сервера (включен/выключен) сохраняется в настройках
  - Порт сервера сохраняется в настройках
  - При перезапуске приложения сервер автоматически запускается, если был включен
  - Сохраненная ссылка для мобильного доступа восстанавливается при запуске

- **Улучшенная система управления статистикой**
  - Добавлены кнопки для уменьшения значений статистики (-1)
  - Исправлена проблема множественных инкрементов при клике
  - Улучшенное отображение статистики с подписями
  - Автоматическое сохранение статистики при изменении

### Изменено
- **Структура настроек vMix**
  - Старая структура: `inputs.lineup = 'Input1'`, общий `overlay: 1`
  - Новая структура: `inputs.lineup = { name: 'Input1', overlay: 1 }`
  - Автоматическая миграция старых настроек в новый формат

- **Интерфейс настроек vMix**
  - Удален блок "Выбор оверлея" с радио-кнопками
  - Добавлены выпадающие списки справа от каждого инпута для выбора оверлея
  - Увеличена ширина выпадающего списка оверлеев (150px) для корректного отображения текста

- **Страница мобильного доступа**
  - Ссылка генерируется один раз при первом запуске сервера (если нет сохраненной)
  - Сохраненная ссылка автоматически загружается и отображается при перезапуске
  - QR-код автоматически генерируется для сохраненной ссылки

- **Логика работы с логотипами**
  - Логотипы сохраняются в гибридном формате: base64 в JSON + PNG файлы в `logos/`
  - Используются фиксированные имена файлов (`logo_a.png`, `logo_b.png`) для предотвращения накопления мусора
  - Автоматическое перезаписывание файлов при сохранении/загрузке матча

### Исправлено
- Исправлена проблема множественных инкрементов статистики при клике (теперь инкрементируется ровно на 1)
- Исправлена проблема с сохранением статистики (теперь автоматически сохраняется при изменении)
- Исправлена проблема с отображением сохраненной ссылки после перезапуска приложения
- Исправлена проблема с импортом `settingsManager` в `server.js`

### Технические детали
- Создан модуль `src/main/settingsManager.js` для работы с глобальными настройками
- Обновлен `src/main/vmix-config.js` для использования нового менеджера настроек
- Обновлены все IPC handlers для работы с async функциями
- Добавлена поддержка миграции настроек при обновлении структуры
- Файл `settings.json` добавлен в `.gitignore`

## [0.1.0] - 2024-XX-XX

### Добавлено
- Базовая структура приложения Electron + React
- Система управления матчами (создание, открытие, сохранение)
- Основной интерфейс управления матчем
- Интеграция с vMix
- Мобильный HTTP сервер
- Мобильный интерфейс для удаленного управления
- Система управления составами команд
- Расширенная статистика
- Управление логотипами команд

