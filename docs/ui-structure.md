# Структура интерфейса приложения

## Общая структура

Приложение использует единый интерфейс на базе React, который отображается как в основном окне Electron, так и в браузере для мобильных устройств. Все страницы открываются через встроенный браузер для унификации.

## Главное окно приложения

### Структура главного окна

```
┌─────────────────────────────────────────────────┐
│  vMix Volley Scoreboard                    [×]  │
├─────────────────────────────────────────────────┤
│  [Меню] [Матч] [Настройки] [О программе]        │
├─────────────────────────────────────────────────┤
│                                                 │
│           [Контент текущей страницы]            │
│                                                 │
└─────────────────────────────────────────────────┘
```

## Страницы приложения

### 1. Страница "Добро пожаловать" / "Главная"

**Назначение:** Первая страница при запуске приложения, выбор действия

**Элементы:**

- Кнопка "Создать новый матч"
- Кнопка "Открыть существующий матч"
- Список последних открытых матчей (опционально)
- Информация о текущем статусе подключения к vMix

**Когда отображается:**

- При первом запуске
- Когда нет открытого матча

---

### 2. Страница "Управление матчем" (основная рабочая страница)

**Назначение:** Главная контрольная панель для ведения счета

**Структура:**

```
┌─────────────────────────────────────────────────────┐
│  Управление матчем                                  │
│  [☑ Автосохранение] [Сохранить] [Сохранить как...]  │
├─────────────────────────────────────────────────────┤
│  Информация о матче                                 │
│  [Турнир] | [Место] | [Дата/Время]                  │
├─────────────────────────────────────────────────────┤
│                                                     │
│  Команда А          │          Команда Б            │
│  [Название]         │          [Название]           │
│  [Цвет формы]       │          [Цвет формы]         │
│                                                     │
│  Счет по партиям:                                   │
│  Партия 1:  [25] - [20]                             │
│  Партия 2:  [23] - [25]                             │
│  Партия 3:  [  ] - [  ]                             │
│  Партия 4:  [  ] - [  ]                             │
│  Партия 5:  [  ] - [  ]                             │
│                                                     │
│  Текущая партия:                                    │
│  [Команда А]  [25] : [20]  [Команда Б]              │
│  Подача: [Команда А]  [◄] [►]                       │
│                                                     │
│  [ -1 ] [ -1 ]    [ +1 ] [ +1 ]                     │
│  Команда А         Команда Б                        │
│                                                     │
│  [Сетбол] [Матчбол]                                 │
│                                                     │
│  [Завершить партию]  [Отменить последнее действие]  │
│                                                     │
│  Расширенная статистика: [Включить]                 │
│  Команда А:                                         │
│  [ -1 ] [ +1 ]  Атака: 15                           │
│  [ -1 ] [ +1 ]  Блок: 8                             │
│  [ -1 ] [ +1 ]  Подачи: 12                          │
│  [ -1 ] [ +1 ]  Ошибки соперника: 5                 │
│  Команда Б:                                         │
│  [ -1 ] [ +1 ]  Атака: 18                           │
│  [ -1 ] [ +1 ]  Блок: 6                             │
│  [ -1 ] [ +1 ]  Подачи: 10                          │
│  [ -1 ] [ +1 ]  Ошибки соперника: 3                 │
│                                                     │
│  Управление плашками vMix:                          │
│  [Заявка ✓] [Статистика] [Состав] [Стартовый состав]│
│  [Текущий счет ✓] [Счет П1] [Счет П2] [Счет П3]     │
│  [Счет П4] [Счет П5] [Судья 1] [Судья 2]            │
│  (✓ = активна в оверлее)                            │
│                                                     │
│  Статус: [Подключено к vMix ✓]                     │
│                                                     │
│  [Мобильный доступ]                                 │
└─────────────────────────────────────────────────────┘
```

**Функциональность:**

- Управление счетом текущей партии
- Отображение счета по всем партиям
- Кнопки для изменения счета (+1, -1 для каждой команды)
- Автоматический учет перехода подачи при начислении очка
- Ручная коррекция подачи (кнопки ◄ ►)
- Отображение индикаторов сетбола и матчбола
- Завершение партии
- Отмена последнего действия
- Переключение расширенной статистики
- Кнопки управления статистикой (Атака, Блок, Подачи, Ошибки соперника)
- Кнопки управления плашками vMix (12 различных плашек)
- State-dependent кнопки плашек: отображение текущего состояния (активна/неактивна в оверлее)
- Синхронизация состояния кнопок с реальным состоянием оверлеев в vMix при установленном соединении
- Визуальная индикация активных плашек (например, подсветка или галочка)
- Индикатор подключения к vMix
- Быстрый доступ к сохранению и мобильному доступу

---

### 3. Страница "Настройки матча"

**Назначение:** Настройка параметров текущего матча

**Разделы:**

#### 3.0. Заголовок с кнопкой смены команд

- Кнопка "⇄ Поменять команды местами" справа от заголовка "Команды"
- При нажатии запрашивается подтверждение
- После подтверждения команды меняются местами со всеми связанными данными

#### 3.1. Информация о турнире

- Заголовок (название турнира) (`tournament`) - текстовое поле
- Подзаголовок (название турнира) (`tournamentSubtitle`) - текстовое поле
- Город, страна (`location`) - текстовое поле
- Место проведения (`venue`) - текстовое поле
- Дата проведения (`date`) - поле даты
- Время начала (`time`) - поле времени

#### 3.2. Команды

- **Заголовок раздела:**
  - Заголовок "Команды"
  - Кнопка "⇄ Поменять команды местами" справа от заголовка
  - При нажатии запрашивается подтверждение
  - После подтверждения команды меняются местами со всеми данными

- **Команда А:**
  - Название команды (текстовое поле)
  - Выбор цвета формы (цветовой пикер)
  - Загрузка логотипа команды
  - Указание тренера команды
  - Загрузка/сохранение состава команды
- **Команда Б:**
  - Название команды (текстовое поле)
  - Выбор цвета формы (цветовой пикер)
  - Загрузка логотипа команды
  - Указание тренера команды
  - Загрузка/сохранение состава команды

#### 3.3. Судейская коллегия

- Главный судья (текстовое поле)
- Судья на линии 1 (текстовое поле)
- Судья на линии 2 (текстовое поле)
- Секретарь (текстовое поле)
- Дополнительные судьи (опционально)

**Кнопки:**

- [⇄ Поменять команды местами] - кнопка в заголовке раздела "Команды"
- [Сохранить изменения]
- [Отмена]

---

### 4. Страница "Настройки vMix"

**Назначение:** Конфигурация подключения к vMix

**Структура (Split-panel layout):**

```
┌─────────────────────────────────────────────────────────────┐
│  Настройки подключения к vMix                               │
├─────────────────┬───────────────────────────────────────────┤
│                 │  Настройки подключения:                   │
│  ВКЛАДКИ        │  IP адрес: [192.168.1.100]               │
│  ИНПУТОВ        │  Порт: [8088]                            │
│  (вертикально)  │  [Тест подключения]                       │
│                 │                                           │
│  ☑ Заявка      │  ────────────────────────────────────────│
│  ☑ Статистика  │  Общие настройки инпута:                 │
│  ☑ Состав      │  ☑ Включить инпут                        │
│  ☑ ...         │  Имя/номер инпута: [Input5]              │
│                 │  Номер оверлея: [1 ▼]                    │
│                 │                                           │
│                 │  ────────────────────────────────────────│
│                 │  Поля инпута:                            │
│                 │  ☑ Команда А (text)                     │
│                 │     fieldIdentifier: [TeamA]             │
│                 │  ☑ Команда Б (text)                     │
│                 │     fieldIdentifier: [TeamB]            │
│                 │  ☑ Поинт А (visibility)                 │
│                 │     fieldIdentifier: [PointA]           │
│                 │  ☑ Цвет А (color)                       │
│                 │     fieldIdentifier: [ColorA]           │
│                 │  ...                                     │
│                 │                                           │
│                 │  [Отмена] [Сохранить настройки]          │
└─────────────────┴───────────────────────────────────────────┘
```

**Функциональность:**

- **Настройки подключения:**
  - Ввод IP адреса и порта vMix
  - Кнопка тестирования подключения с отображением статуса

- **Левая панель (вкладки инпутов):**
  - Список всех инпутов в виде вертикальных вкладок
  - Чекбокс для включения/выключения каждого инпута
  - Выделение активной вкладки
  - При клике открывается панель редактирования справа

- **Правая панель (редактирование инпута):**
  - **Общие настройки инпута:**
    - Переключатель "Включить инпут"
    - Поле "Имя или номер инпута" (поддержка как номеров, так и имен)
    - Выпадающий список "Номер оверлея" (1-8)
  - **Настройка полей:**
    - Список всех полей для выбранного инпута
    - Для каждого поля:
      - Чекбокс включения/выключения
      - Название поля и тип (текст, цвет, видимость, изображение)
      - Поле для редактирования `fieldIdentifier` (кастомное имя для vMix)
      - Визуальные индикаторы типов полей

- **Сохранение:**
  - Кнопка "Сохранить настройки" сохраняет все изменения в `settings.json`
  - Автоматическая загрузка настроек при запуске приложения
  - Автоматическая миграция старых настроек в новый формат

---

### 5. Страница "Мобильный доступ"

**Назначение:** Генерация и управление доступом для мобильных устройств

**Элементы:**

```
┌─────────────────────────────────────────────────┐
│  Мобильный доступ                               │
├─────────────────────────────────────────────────┤
│  Статус сервера: [Запущен ✓]                    │
│  Адрес сервера: http://192.168.1.50:3000        │
│  IP адрес: 192.168.1.50                         │
│  Порт: 3000                                     │
│                                                 │
│  Уникальная ссылка для доступа:                 │
│  ┌─────────────────────────────────────────┐   │
│  │ http://192.168.1.50:3000/panel/abc123   │   │
│  └─────────────────────────────────────────┘   │
│  [Копировать ссылку] [Сгенерировать новую]     │
│                                                 │
│  QR-код для быстрого подключения:               │
│  ┌─────────────┐                                │
│  │             │                                │
│  │   [QR-код]  │                                │
│  │             │                                │
│  └─────────────┘                                │
│                                                 │
│  [Запустить сервер] / [Остановить сервер]        │
└─────────────────────────────────────────────────┘
```

**Функциональность:**

- Отображение статуса встроенного HTTP сервера
- Генерация уникальной ссылки для доступа (один раз при первом запуске, если нет сохраненной)
- Автоматическое восстановление сохраненной ссылки при перезапуске приложения
- Отображение QR-кода со ссылкой
- Копирование ссылки в буфер обмена
- Возможность генерации новой ссылки (старая становится недействительной)
- Управление сервером (запуск/остановка)
- Автоматический запуск сервера при перезапуске приложения, если он был включен
- Сохранение состояния сервера и ссылки в глобальных настройках

---

### 6. Мобильный интерфейс (браузер)

**Назначение:** Упрощенная версия контрольной панели для мобильных устройств

**Структура:**

```
┌─────────────────────────────────┐
│  vMix Volley Scoreboard         │
├─────────────────────────────────┤
│                                 │
│  Команда А    │    Команда Б    │
│  [Название]   │    [Название]   │
│                                 │
│  Текущий счет:                  │
│  [25] : [20]                    │
│                                 │
│  [ -1 ]  [ -1 ]                 │
│  Команда А    Команда Б         │
│                                 │
│  [ +1 ]  [ +1 ]                 │
│  Команда А    Команда Б         │
│                                 │
│  Счет по партиям:               │
│  Партия 1: [25] - [20]          │
│  Партия 2: [23] - [25]          │
│  Партия 3: [  ] - [  ]          │
│                                 │
│  Подача: [Команда А]            │
│                                 │
│  [Завершить партию]             │
│  [Отменить]                     │
│                                 │
│  Статус: [Синхронизировано ✓]   │
└─────────────────────────────────┘
```

**Особенности:**

- Адаптивный дизайн для мобильных устройств
- Крупные кнопки для удобного управления
- Минималистичный интерфейс (без управления плашками vMix)
- Отображение текущей подачи
- Автоматическая синхронизация с основным приложением
- Отображение статуса синхронизации
- Расширенная статистика доступна только в десктопной версии

---

### 7. Страница "Управление составами команд"

**Назначение:** Загрузка, редактирование и сохранение составов команд

**Элементы:**

```
┌─────────────────────────────────────────────────┐
│  Управление составами команд                   │
├─────────────────────────────────────────────────┤
│  Выбор команды: [Команда А ▼] [Команда Б ▼]   │
│                                                 │
│  Команда: [Название команды]                   │
│  Логотип: [Загрузить] [Удалить]                │
│  [Превью логотипа]                             │
│                                                 │
│  Тренер: [Имя тренера]                         │
│                                                 │
│  Состав команды:                                │
│  №  Имя              Позиция                    │
│  1  [Иванов И.И.]    [Нападающий ▼]            │
│  2  [Петров П.П.]    [Связующий ▼]             │
│  ...                                            │
│  [Добавить игрока] [Удалить]                    │
│                                                 │
│  Стартовый состав (отметить игроков):          │
│  ☑ 1  ☑ 2  ☐ 3  ☑ 4  ☑ 5  ☑ 6                  │
│                                                 │
│  [Сохранить состав] [Загрузить из файла]       │
│  [Экспорт в файл]                               │
└─────────────────────────────────────────────────┘
```

**Функциональность:**

- Загрузка и сохранение составов для каждой команды
- Загрузка логотипов команд (изображения)
- Указание тренера команды
- Редактирование списка игроков (добавление, удаление)
- Указание позиции каждого игрока
- Выбор стартового состава
- Импорт/экспорт составов в файлы

---

## Навигация

### Меню приложения

- **Файл:**
  - Создать новый матч
  - Открыть матч...
  - ☑ Автосохранение (галочка, включено по умолчанию)
  - Сохранить матч
  - Сохранить матч как...
  - Выход
- **Вид:**
  - Настройки матча
  - Настройки vMix
  - Мобильный доступ
- **Справка:**
  - О программе

### Горячие клавиши

- `Ctrl+N` - Создать новый матч
- `Ctrl+O` - Открыть матч
- `Ctrl+S` - Сохранить матч
- `F5` - Обновить данные в vMix (ручное обновление)

---

## Состояния интерфейса

### Состояние "Нет открытого матча"

- Отображается страница "Добро пожаловать"
- Доступны только: создание/открытие матча, настройки vMix

### Состояние "Матч открыт"

- Отображается страница "Управление матчем"
- Все функции доступны
- Автоматическое обновление vMix

### Состояние "Ошибка подключения к vMix"

- Индикатор показывает ошибку
- Возможность повторного подключения
- Работа приложения продолжается, но без обновления vMix

---

## Адаптивность

- Десктопная версия: полнофункциональный интерфейс со всеми элементами
- Мобильная версия: упрощенный интерфейс с основными функциями управления счетом
- Единая кодовая база для обеих версий (React компоненты)
