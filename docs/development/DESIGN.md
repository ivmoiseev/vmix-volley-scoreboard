# Дизайн и темы приложения vMix Volley Scoreboard

*Последнее обновление: 2026-02-05*

Документ описывает **текущее состояние** системы дизайна: токены, темы, компоненты и ключевые решения по оформлению интерфейса.

---

## 1. Design tokens

### 1.1. Расположение

- **Общие токены (темы, отступы, радиусы, типографика):** `src/shared/theme/tokens.js` — используются в main (мобильная панель) и в renderer.
- **Реэкспорт в renderer:** `src/renderer/theme/tokens.js` реэкспортирует из shared.
- **Применение темы к DOM:** `src/renderer/theme/applyTheme.js` — записывает объект темы (light/dark) в CSS-переменные на `document.documentElement`.

### 1.2. Цветовые токены тем

| Токен | Светлая тема | Тёмная тема | Назначение |
|-------|--------------|-------------|------------|
| background | #f5f5f5 | #121212 | Фон страницы |
| surface | #ffffff | #252525 | Карточки, панели, поля ввода |
| surfaceMuted | #ecf0f1 | #383838 | Приглушённые блоки |
| text | #2c3e50 | #e8e8e8 | Основной текст |
| textSecondary | #7f8c8d | #b0b0b0 | Вторичный текст |
| primary | #3498db | #3498db | Основные кнопки, акценты |
| success | #27ae60 | #27ae60 | Успех, «+1» |
| danger | #e74c3c | #e74c3c | Удаление, «-1» |
| warning | #f39c12 | #f39c12 | Предупреждение, сетбол |
| border | #bdc3c7 | #404040 | Рамки |
| headerBg | #2c3e50 | #1a1a1a | Шапка страниц |
| servingBorder | #3498db | #5dade2 | Рамка подающей команды |
| servingBadge | #3498db | #3498db | Бейдж «Подача» (ServeControl) |

В коде используются **CSS-переменные** вида `var(--color-text)`, `var(--color-surface)` и т.д. Имена получаются из ключей токенов (camelCase → kebab-case с префиксом `--color-`).

### 1.3. Отступы, радиусы, типографика

- **space:** xs, sm, md, lg, xl (0.25rem … 2rem).
- **radius:** sm (4px), md (8px), lg (12px).
- **typography:** fontFamily, h1–h4, body, small, caption.

Импорт: `import { space, radius, typography } from '../theme/tokens'` (в renderer).

---

## 2. Тема (светлая / тёмная)

### 2.1. Настройка и хранение

- В **settings.json** (через settingsManager): секция `ui.theme` — значение `'light' | 'dark' | 'system'`. По умолчанию `'light'`.
- При `'system'` используется `prefers-color-scheme: dark` для выбора темы.

### 2.2. Переключение темы

- **Десктоп:** переключатель темы вынесен из шапки в **меню приложения → Вид → «Переключить тему (светлая ↔ тёмная)»**. Кнопки в header нет.
- При выборе пункта меню main-процесс читает текущую тему, переключает на противоположную, сохраняет в настройки и отправляет в renderer событие `ui-theme-changed`. App.jsx применяет тему через `applyTheme(light | dark)`.

### 2.3. Применение темы в renderer

- В **App.jsx** при загрузке читается `getUISettings()`, при смене темы из меню — подписка на `onUIThemeChanged`. Текущая тема (light/dark) передаётся в `applyTheme(themeObject)`.
- **applyTheme.js** записывает все ключи объекта темы в `document.documentElement.style` как `--color-*`. Глобальные стили в **index.html** задают для `body` и `#root` цвет и фон через `var(--color-text)`, `var(--color-background)` с fallback для светлой темы.

### 2.4. Тёмная тема — оформление

- Подложки в тёмной теме построены на **градациях серого** (background, surface, surfaceMuted, headerBg), без тёмно-синих блоков.
- Мобильная панель (`server.ts`) получает тему из настроек и подставляет в генерируемый HTML блок `:root { --color-*: ... }` из shared-токенов; для тёмной темы на `body` выставляется `data-theme="dark"`, стили дублируют градации серого.

---

## 3. Поля ввода и выпадающие списки

- В **index.html** заданы глобальные стили для полей ввода в цветах темы:
  - `input:not([type="color"]):not([type="file"])`, `select`, `textarea`: `background-color: var(--color-surface)`, `color: var(--color-text)`, `border: 1px solid var(--color-border)`.
  - `select option`: те же фон и цвет текста.
- Исключения: `input[type="color"]` и `input[type="file"]` не переопределяются (нативный вид).
- В тёмной теме поля имеют тёмную подложку и светлую окантовку, без белых «пятен».

---

## 4. Ключевые компоненты

### 4.1. Button

- **Файл:** `src/renderer/components/Button.jsx`.
- **Варианты:** primary, secondary, success, danger, warning, accent. Стили берутся из токенов (backgroundColor, color). При `disabled` добавляются `opacity: 0.7`, `cursor: not-allowed`. В обычном состоянии — `opacity: 1`, `cursor: pointer` из baseStyle.

### 4.2. ScoreDisplay (блок счёта)

- **Ширина блоков команд:** фиксированная (`TEAM_BLOCK_WIDTH = 200`), чтобы не было скачков при разной длине названий.
- **Подающая команда:** выделяется только **рамкой** (`var(--color-serving-border)`). Плашка «Подача» в блоке счёта убрана; кто подаёт, видно в блоке ServeControl.
- **Название команды:** уменьшенный шрифт (`TEAM_NAME_FONT_SIZE = 0.875rem`), при длинном тексте — обрезка с многоточием (`overflow: hidden`, `textOverflow: ellipsis`, `whiteSpace: nowrap`).
- **Сетбол/матчбол:** плашки отображаются **под цифрой счёта** (не в наложении), фиксированная высота блока под плашку (`SCORE_BADGE_BLOCK_MIN_HEIGHT`), чтобы высота не менялась при появлении/исчезновении.
- **Логотипы:** оба контейнера (команда A и B) с `minWidth/minHeight: 120px`, `flexShrink: 0`, чтобы не сжимались при узком экране.

### 4.3. Блок «Расширенная статистика» (MatchControlPage)

- Раскрытие/сворачивание **только по галочке** «Расширенная статистика». Отдельной кнопки «Развернуть/Свернуть» нет.

### 4.4. Минимальная ширина левой колонки (Управление матчем)

- Левая колонка (блок управления матчем) имеет `minWidth: 790px`, чтобы контент не «сжимался» при узком окне.

---

## 5. Оформление блоков по страницам

- **Welcome:** блок «Быстрый старт» — `var(--color-surface-muted)`, рамка `var(--color-border)`, текст `var(--color-text)`.
- **Мобильный доступ:** блок инструкции оформлен так же, как «Быстрый старт» на Welcome (surface-muted, border, цвет текста). Блоки ссылки и QR-кода — `var(--color-surface)`, цвет текста из темы.
- **Настройки матча:** выпадающий список «Часовой пояс» без захардкоженного белого фона — подхватывает глобальные стили темы.
- **Управление составами:** таблица состава и сетка расстановки используют `var(--color-surface)` и `var(--color-text)`; при сбросе фона ячейки при drag — `var(--color-surface)`.
- **Настройки vMix, «Настройка инпутов»:** левая панель (список инпутов) и правая панель (настройки выбранного инпута) — `var(--color-surface)`, цвет текста и подписей из темы. Модальное окно «Добавить инпут» и VMixInputFieldsPanel (заголовки блоков, подписи) — те же токены.

---

## 6. Доступность

- В **index.html** заданы стили `:focus-visible` для button, input, select, textarea, a — контур фокуса `var(--color-primary)`. Это обеспечивает видимый фокус при навигации с клавиатуры (Tab).

---

## 7. Связанные документы

- **[Структура UI](getting-started/ui-structure.md)** — описание страниц и навигации (включая меню и тему).
- **[Аудит UI/UX](ui-ux-audit-report.md)** — исходный аудит; многие рекомендации реализованы, текущее состояние — в этом документе.
- **[Инструкции по рефакторингу дизайна](design-refactoring-implementation-guide.md)** — пошаговый план выполненных этапов (историческая справка).
